<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRM - Sistema de Gestão</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: { 50: '#f0f4ff', 100: '#e0e7ff', 500: '#1e3a5f', 600: '#162d4d', 700: '#0f1f33' }
                    }
                }
            }
        }
    </script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        * { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; }
        body { background-color: #f8fafc; color: #1e293b; }
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        .badge { padding: 0.375rem 0.75rem; border-radius: 9999px; font-size: 0.7rem; font-weight: 500; letter-spacing: 0.025em; }
        .badge-success { background-color: #ecfdf5; color: #059669; }
        .badge-warning { background-color: #fffbeb; color: #d97706; }
        .badge-danger { background-color: #fef2f2; color: #dc2626; }
        .badge-info { background-color: #eff6ff; color: #2563eb; }
        .badge-neutral { background-color: #f1f5f9; color: #475569; }
        
        .status-badge, .tag-badge, .stock-badge { padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; }
        .status-ativo { background-color: #ecfdf5; color: #059669; }
        .status-risco { background-color: #fffbeb; color: #d97706; }
        .status-inativo { background-color: #fef2f2; color: #dc2626; }
        .status-sem-historico { background-color: #eff6ff; color: #2563eb; }
        .tag-fiel { background-color: #fef9c3; color: #854d0e; }
        .stock-in { background-color: #ecfdf5; color: #059669; }
        .stock-out { background-color: #fef2f2; color: #dc2626; }
        .stock-unmanaged { background-color: #eff6ff; color: #2563eb; }
        
        .nav-item { display: flex; align-items: center; padding: 0.625rem 1rem; border-radius: 0.75rem; color: #64748b; font-size: 0.875rem; font-weight: 500; transition: all 0.15s ease; gap: 0.75rem; }
        .nav-item:hover { background-color: #f1f5f9; color: #1e293b; }
        .nav-item.active, .nav-link.active { background-color: #1e3a5f; color: white; }
        .nav-item.active:hover { background-color: #162d4d; }
        
        .card { background: white; border-radius: 1rem; box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.05); border: 1px solid #f1f5f9; }
        .card-hover:hover { box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05); transform: translateY(-1px); transition: all 0.2s ease; }
        
        .btn { display: inline-flex; align-items: center; justify-content: center; padding: 0.625rem 1.25rem; font-size: 0.875rem; font-weight: 500; border-radius: 0.75rem; transition: all 0.15s ease; gap: 0.5rem; }
        .btn-primary { background-color: #1e3a5f; color: white; }
        .btn-primary:hover { background-color: #162d4d; }
        .btn-secondary { background-color: #f1f5f9; color: #475569; }
        .btn-secondary:hover { background-color: #e2e8f0; }
        .btn-success { background-color: #059669; color: white; }
        .btn-success:hover { background-color: #047857; }
        .btn-danger { background-color: #dc2626; color: white; }
        .btn-danger:hover { background-color: #b91c1c; }
        
        .input { width: 100%; padding: 0.625rem 1rem; font-size: 0.875rem; border: 1px solid #e2e8f0; border-radius: 0.75rem; background: white; transition: all 0.15s ease; }
        .input:focus { outline: none; border-color: #1e3a5f; box-shadow: 0 0 0 3px rgba(30, 58, 95, 0.1); }
        
        .toast-container { position: fixed; top: 1.5rem; right: 1.5rem; z-index: 1000; }
        .toast-notification { background-color: #fff; color: #1e293b; padding: 1rem 1.5rem; border-radius: 0.75rem; box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1); transform: translateX(120%); transition: transform 0.3s ease-in-out; margin-bottom: 1rem; border-left: 4px solid; }
        .toast-notification.show { transform: translateX(0); }
        .toast-success { border-color: #059669; }
        .toast-error { border-color: #dc2626; }
        .toast-info { border-color: #2563eb; }
        
        .table-header { font-size: 0.7rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; color: #64748b; }
        .modal-overlay, .modal-bg { background-color: rgba(15, 23, 42, 0.6); backdrop-filter: blur(4px); }
        
        .metric-card { background: white; border-radius: 1rem; padding: 1.5rem; border: 1px solid #f1f5f9; }
        .metric-value { font-size: 2rem; font-weight: 700; color: #1e293b; line-height: 1; }
        .metric-label { font-size: 0.8rem; font-weight: 500; color: #64748b; margin-bottom: 0.5rem; }
        .metric-sublabel { font-size: 0.7rem; color: #94a3b8; margin-top: 0.25rem; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen">
    <div class="flex h-screen">
        <!-- Sidebar -->
        <aside class="w-64 bg-white border-r border-slate-100 flex flex-col">
            <div class="px-6 py-6 border-b border-slate-100">
                <h1 class="text-xl font-semibold text-slate-800">CRM</h1>
                <p class="text-xs text-slate-400 mt-0.5">Sistema de Gestão</p>
            </div>
            <nav class="flex-1 px-3 py-4 space-y-1 overflow-y-auto">
                <a href="#" id="nav-dashboard" class="nav-item active">
                    <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
                    <span>Dashboard</span>
                    <span id="alerts-badge" class="ml-auto bg-red-500 text-white text-xs px-2 py-0.5 rounded-full hidden">0</span>
                </a>
                <a href="atendimentos.html" class="nav-item bg-emerald-50 text-emerald-700 hover:bg-emerald-100">
                    <i data-lucide="message-circle" class="w-5 h-5"></i>
                    <span class="font-semibold">Atendimento</span>
                </a>
                <a href="anny.html" class="nav-item bg-purple-50 text-purple-700 hover:bg-purple-100">
                    <i data-lucide="sparkles" class="w-5 h-5"></i>
                    <span class="font-semibold">Anny BI</span>
                </a>
                <a href="#" id="nav-clients" class="nav-item">
                    <i data-lucide="users" class="w-5 h-5"></i>
                    <span>Clientes</span>
                </a>
                <a href="#" id="nav-campaigns" class="nav-item">
                    <i data-lucide="megaphone" class="w-5 h-5"></i>
                    <span>Campanhas</span>
                </a>
                <a href="#" id="nav-coupons" class="nav-item">
                    <i data-lucide="ticket" class="w-5 h-5"></i>
                    <span>Gestão de Cupons</span>
                </a>
                <div class="pt-4 mt-4 border-t border-slate-100">
                    <p class="px-3 mb-2 text-xs font-medium text-slate-400 uppercase tracking-wider">Dados</p>
                    <a href="#" id="nav-products" class="nav-item">
                        <i data-lucide="package" class="w-5 h-5"></i>
                        <span>Produtos</span>
                    </a>
                    <a href="#" id="nav-orders" class="nav-item">
                        <i data-lucide="receipt" class="w-5 h-5"></i>
                        <span>Pedidos</span>
                    </a>
                    <a href="#" id="nav-webhooks" class="nav-item">
                        <i data-lucide="zap" class="w-5 h-5"></i>
                        <span>Webhooks</span>
                        <span id="webhook-badge" class="ml-auto bg-red-500 text-white text-xs px-2 py-0.5 rounded-full hidden">0</span>
                    </a>
                </div>
                <div class="pt-4 mt-4 border-t border-slate-100">
                    <p class="px-3 mb-2 text-xs font-medium text-slate-400 uppercase tracking-wider">Sistema</p>
                    <a href="#" id="sync-button" class="nav-item">
                        <i data-lucide="refresh-cw" class="w-5 h-5"></i>
                        <span>Sincronizar</span>
                    </a>
                    <div class="px-3 py-3">
                        <p class="text-xs text-slate-400 mb-2 flex items-center gap-1">
                            <i data-lucide="cloud" class="w-3 h-3"></i> Nuvem (Supabase)
                        </p>
                        <div class="flex gap-2">
                            <button onclick="SupabaseSync.sync()" class="flex-1 btn btn-success text-xs py-1.5">
                                <i data-lucide="upload-cloud" class="w-3 h-3"></i> Salvar
                            </button>
                            <button onclick="SupabaseSync.download()" class="flex-1 btn btn-primary text-xs py-1.5">
                                <i data-lucide="download-cloud" class="w-3 h-3"></i> Baixar
                            </button>
                        </div>
                    </div>
                    <a href="#" id="import-legacy-button" class="nav-item">
                        <i data-lucide="file-up" class="w-5 h-5"></i>
                        <span>Importar Legado</span>
                    </a>
                    <a href="#" id="open-settings-button" class="nav-item">
                        <i data-lucide="settings" class="w-5 h-5"></i>
                        <span>Configurações</span>
                    </a>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col overflow-hidden">
            <!-- DASHBOARD PAGE -->
            <div id="dashboard-page" class="page-content flex flex-col h-full">
                <header class="bg-white border-b border-slate-100 px-8 py-5">
                    <div class="flex justify-between items-center">
                        <div>
                            <h1 class="text-xl font-semibold text-slate-800">Dashboard - Central de Ação</h1>
                            <p class="text-sm text-slate-500 mt-0.5">Oportunidades identificadas pela IA Vigilante</p>
                        </div>
                        <button id="run-vigilante-btn" class="btn btn-primary">
                            <i data-lucide="brain" class="w-4 h-4"></i>
                            Rodar IA Vigilante
                        </button>
                    </div>
                </header>
                <div class="flex-1 overflow-y-auto p-8 bg-slate-50">
                    <div class="container mx-auto">
                        <!-- KPIs -->
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5 mb-8">
                            <div class="metric-card">
                                <div class="flex items-start justify-between">
                                    <div>
                                        <p class="metric-label">Urgentes Hoje</p>
                                        <p class="metric-value text-red-600" id="dash-urgent-count">0</p>
                                        <p class="metric-sublabel">Clientes precisam de ação</p>
                                    </div>
                                    <div class="w-10 h-10 rounded-xl bg-red-50 flex items-center justify-center">
                                        <i data-lucide="alert-circle" class="w-5 h-5 text-red-500"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="metric-card">
                                <div class="flex items-start justify-between">
                                    <div>
                                        <p class="metric-label">Valor em Risco</p>
                                        <p class="metric-value text-amber-600" id="dash-risk-value">R$ 0</p>
                                        <p class="metric-sublabel">Ticket dos inativos</p>
                                    </div>
                                    <div class="w-10 h-10 rounded-xl bg-amber-50 flex items-center justify-center">
                                        <i data-lucide="trending-down" class="w-5 h-5 text-amber-500"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="metric-card">
                                <div class="flex items-start justify-between">
                                    <div>
                                        <p class="metric-label">Recuperados (Mês)</p>
                                        <p class="metric-value text-emerald-600" id="dash-recovered-count">0</p>
                                        <p class="metric-sublabel">Usaram cupons</p>
                                    </div>
                                    <div class="w-10 h-10 rounded-xl bg-emerald-50 flex items-center justify-center">
                                        <i data-lucide="user-check" class="w-5 h-5 text-emerald-500"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="metric-card">
                                <div class="flex items-start justify-between">
                                    <div>
                                        <p class="metric-label">ROI Cupons</p>
                                        <p class="metric-value text-violet-600" id="dash-coupon-roi">0%</p>
                                        <p class="metric-sublabel">Taxa de conversão</p>
                                    </div>
                                    <div class="w-10 h-10 rounded-xl bg-violet-50 flex items-center justify-center">
                                        <i data-lucide="percent" class="w-5 h-5 text-violet-500"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ANNY AI - Proactive Insights -->
                        <div class="card mb-8 border-purple-100 bg-gradient-to-r from-purple-50/50 to-white">
                            <div class="px-6 py-4 border-b border-purple-100 flex justify-between items-center">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-purple-500 to-purple-600 flex items-center justify-center">
                                        <i data-lucide="sparkles" class="w-5 h-5 text-white"></i>
                                    </div>
                                    <div>
                                        <h3 class="font-semibold text-slate-800">Alertas da Anny</h3>
                                        <p class="text-xs text-slate-500">Sua assistente de BI identificou oportunidades</p>
                                    </div>
                                </div>
                                <a href="anny.html" class="btn text-sm py-2 px-4 bg-gradient-to-r from-purple-500 to-purple-600 text-white hover:from-purple-600 hover:to-purple-700">
                                    <i data-lucide="message-circle" class="w-4 h-4"></i>
                                    Falar com Anny
                                </a>
                            </div>
                            <div class="p-4">
                                <div id="anny-insights-grid" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <!-- Insight: VIPs Aniversariantes -->
                                    <div class="bg-white rounded-xl border border-pink-100 p-4 hover:shadow-md transition-all cursor-pointer" onclick="window.location.href='anny.html'">
                                        <div class="flex items-start gap-3">
                                            <div class="w-8 h-8 rounded-lg bg-pink-50 flex items-center justify-center flex-shrink-0">
                                                <i data-lucide="cake" class="w-4 h-4 text-pink-500"></i>
                                            </div>
                                            <div class="flex-1 min-w-0">
                                                <p class="text-sm font-medium text-slate-800" id="anny-birthday-title">Carregando...</p>
                                                <p class="text-xs text-slate-500 mt-0.5" id="anny-birthday-desc">Aniversariantes do mês</p>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Insight: VIPs Inativos -->
                                    <div class="bg-white rounded-xl border border-red-100 p-4 hover:shadow-md transition-all cursor-pointer" onclick="window.location.href='anny.html'">
                                        <div class="flex items-start gap-3">
                                            <div class="w-8 h-8 rounded-lg bg-red-50 flex items-center justify-center flex-shrink-0">
                                                <i data-lucide="user-x" class="w-4 h-4 text-red-500"></i>
                                            </div>
                                            <div class="flex-1 min-w-0">
                                                <p class="text-sm font-medium text-slate-800" id="anny-vip-title">Carregando...</p>
                                                <p class="text-xs text-slate-500 mt-0.5" id="anny-vip-desc">VIPs que pararam de comprar</p>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Insight: Grade Fechada -->
                                    <div class="bg-white rounded-xl border border-amber-100 p-4 hover:shadow-md transition-all cursor-pointer" onclick="window.location.href='anny.html'">
                                        <div class="flex items-start gap-3">
                                            <div class="w-8 h-8 rounded-lg bg-amber-50 flex items-center justify-center flex-shrink-0">
                                                <i data-lucide="crown" class="w-4 h-4 text-amber-500"></i>
                                            </div>
                                            <div class="flex-1 min-w-0">
                                                <p class="text-sm font-medium text-slate-800" id="anny-grade-title">Clientes de Grade</p>
                                                <p class="text-xs text-slate-500 mt-0.5" id="anny-grade-desc">Compradores de volume</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Alerts -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                            <div class="card">
                                <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 rounded-lg bg-red-50 flex items-center justify-center">
                                            <i data-lucide="flame" class="w-4 h-4 text-red-500"></i>
                                        </div>
                                        <h3 class="font-semibold text-slate-800">Clientes Urgentes</h3>
                                    </div>
                                    <div class="flex gap-2">
                                        <button onclick="AIVigilante.exportUrgentCSV()" class="btn btn-secondary text-xs py-1.5 px-3">
                                            <i data-lucide="download" class="w-3 h-3"></i> Exportar
                                        </button>
                                        <button id="action-all-urgent" class="btn btn-danger text-xs py-1.5 px-3">
                                            <i data-lucide="zap" class="w-3 h-3"></i> Ação em Massa
                                        </button>
                                    </div>
                                </div>
                                <div id="urgent-clients-list" class="divide-y divide-slate-50 max-h-80 overflow-y-auto">
                                    <div class="p-8 text-center">
                                        <div class="w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-3">
                                            <i data-lucide="check-circle" class="w-6 h-6 text-slate-400"></i>
                                        </div>
                                        <p class="text-slate-500 text-sm">Nenhuma urgência no momento</p>
                                        <p class="text-slate-400 text-xs mt-1">Clique em "Rodar IA Vigilante" para analisar</p>
                                    </div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 rounded-lg bg-emerald-50 flex items-center justify-center">
                                            <i data-lucide="gem" class="w-4 h-4 text-emerald-500"></i>
                                        </div>
                                        <h3 class="font-semibold text-slate-800">Oportunidades de Upsell</h3>
                                    </div>
                                    <span id="upsell-count" class="text-sm text-slate-400">0 clientes</span>
                                </div>
                                <div id="upsell-clients-list" class="divide-y divide-slate-50 max-h-80 overflow-y-auto">
                                    <div class="p-8 text-center">
                                        <div class="w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-3">
                                            <i data-lucide="sparkles" class="w-6 h-6 text-slate-400"></i>
                                        </div>
                                        <p class="text-slate-500 text-sm">Analisando oportunidades...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Late Clients -->
                        <div class="card mb-8">
                            <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center">
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 rounded-lg bg-amber-50 flex items-center justify-center">
                                        <i data-lucide="clock" class="w-4 h-4 text-amber-500"></i>
                                    </div>
                                    <h3 class="font-semibold text-slate-800">Clientes Atrasados (Fora do Padrão)</h3>
                                </div>
                                <span id="late-count" class="text-sm text-slate-400">0 clientes</span>
                            </div>
                            <div id="late-clients-list" class="divide-y divide-slate-50 max-h-64 overflow-y-auto">
                                <div class="p-8 text-center">
                                    <div class="w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-3">
                                        <i data-lucide="calendar-check" class="w-6 h-6 text-slate-400"></i>
                                    </div>
                                    <p class="text-slate-500 text-sm">Clientes que compravam regularmente mas atrasaram</p>
                                </div>
                            </div>
                        </div>
                        <!-- Quick Actions -->
                        <div class="card bg-gradient-to-br from-slate-800 to-slate-900 border-0">
                            <div class="p-6">
                                <h3 class="text-lg font-semibold text-white mb-5">Ações Rápidas</h3>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                    <button id="quick-action-inactive" class="bg-white/10 hover:bg-white/15 rounded-xl p-5 text-center transition-all">
                                        <div class="w-10 h-10 rounded-lg bg-white/10 flex items-center justify-center mx-auto mb-3">
                                            <i data-lucide="user-x" class="w-5 h-5 text-white"></i>
                                        </div>
                                        <p class="text-sm font-medium text-white">Reativar Inativos</p>
                                        <p class="text-xs text-white/60 mt-1" id="quick-inactive-count">0 clientes</p>
                                    </button>
                                    <button id="quick-action-birthday" class="bg-white/10 hover:bg-white/15 rounded-xl p-5 text-center transition-all">
                                        <div class="w-10 h-10 rounded-lg bg-white/10 flex items-center justify-center mx-auto mb-3">
                                            <i data-lucide="cake" class="w-5 h-5 text-white"></i>
                                        </div>
                                        <p class="text-sm font-medium text-white">Aniversariantes</p>
                                        <p class="text-xs text-white/60 mt-1" id="quick-birthday-count">0 este mês</p>
                                    </button>
                                    <button id="quick-action-vip" class="bg-white/10 hover:bg-white/15 rounded-xl p-5 text-center transition-all">
                                        <div class="w-10 h-10 rounded-lg bg-white/10 flex items-center justify-center mx-auto mb-3">
                                            <i data-lucide="crown" class="w-5 h-5 text-white"></i>
                                        </div>
                                        <p class="text-sm font-medium text-white">Mimar VIPs</p>
                                        <p class="text-xs text-white/60 mt-1" id="quick-vip-count">0 VIPs</p>
                                    </button>
                                    <button id="quick-action-cart" class="bg-white/10 hover:bg-white/15 rounded-xl p-5 text-center transition-all">
                                        <div class="w-10 h-10 rounded-lg bg-white/10 flex items-center justify-center mx-auto mb-3">
                                            <i data-lucide="shopping-cart" class="w-5 h-5 text-white"></i>
                                        </div>
                                        <p class="text-sm font-medium text-white">Carrinhos Abandonados</p>
                                        <p class="text-xs text-white/60 mt-1" id="quick-cart-count">0 carrinhos</p>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CLIENTS PAGE -->
            <div id="clients-page" class="page-content hidden flex flex-col h-full">
                <header class="bg-white border-b border-slate-100 px-8 py-5">
                    <div class="flex justify-between items-center">
                        <div class="flex items-baseline gap-3">
                            <h1 class="text-xl font-semibold text-slate-800">Painel de Clientes</h1>
                            <span id="client-count-display" class="text-sm text-slate-400"></span>
                        </div>
                        <button id="add-client-button" class="btn btn-primary">
                            <i data-lucide="plus" class="w-4 h-4"></i> Adicionar Cliente
                        </button>
                    </div>
                </header>
                <div class="flex-1 overflow-y-auto p-8 bg-slate-50">
                    <div class="container mx-auto">
                        <div class="card p-5 mb-6">
                            <div class="flex flex-wrap items-center gap-4">
                                <div class="flex-1 min-w-[250px]">
                                    <div class="relative">
                                        <i data-lucide="search" class="w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"></i>
                                        <input type="text" id="search-input" class="input pl-10" placeholder="Buscar por nome, e-mail...">
                                    </div>
                                </div>
                                <select id="filter-status" class="input w-auto"><option value="todos">Todos os Status</option><option value="ativo">Ativo</option><option value="em-risco">Em Risco</option><option value="inativo">Inativo</option><option value="sem-historico">Sem Histórico</option></select>
                                <select id="filter-tag" class="input w-auto"><option value="todos">Todas as Tags</option><option value="cliente-fiel">Cliente Fiel</option></select>
                                <select id="sort-clients" class="input w-auto"><option value="default">Ordenar por Padrão</option><option value="most-orders">Mais Pedidos</option><option value="least-orders">Menos Pedidos</option><option value="highest-spent">Maior Valor Gasto</option><option value="lowest-spent">Menor Valor Gasto</option></select>
                                <button onclick="AIVigilante.exportAllClientsCSV()" class="btn btn-success">
                                    <i data-lucide="download" class="w-4 h-4"></i> Exportar CSV
                                </button>
                            </div>
                        </div>
                        <div id="client-cards-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
                        <div id="no-clients-message" class="hidden card p-12 text-center">
                            <div class="w-16 h-16 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-4">
                                <i data-lucide="users" class="w-8 h-8 text-slate-400"></i>
                            </div>
                            <h3 class="font-medium text-slate-800">Nenhum cliente encontrado</h3>
                            <p class="text-sm text-slate-500 mt-1">Clique em "Sincronizar Dados" ou adicione um novo cliente.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PRODUCTS PAGE -->
            <div id="products-page" class="page-content hidden flex-col h-full">
                <header class="bg-white border-b border-slate-100 px-8 py-5">
                    <div class="flex items-baseline gap-3">
                        <h1 class="text-xl font-semibold text-slate-800">Painel de Produtos</h1>
                        <span id="product-count-display" class="text-sm text-slate-400"></span>
                    </div>
                </header>
                <div class="flex-1 overflow-y-auto p-8 bg-slate-50">
                    <div class="container mx-auto">
                        <div class="card p-5 mb-6">
                            <div class="flex flex-wrap items-center gap-4">
                                <div class="flex-1 min-w-[250px]">
                                    <div class="relative">
                                        <i data-lucide="search" class="w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"></i>
                                        <input type="text" id="product-search-input" class="input pl-10" placeholder="Buscar por nome, SKU...">
                                    </div>
                                </div>
                                <select id="filter-stock" class="input w-auto"><option value="todos">Todo o Estoque</option><option value="gerenciado">Gerenciado</option><option value="nao-gerenciado">Não Gerenciado</option><option value="em-estoque">Em Estoque</option><option value="sem-estoque">Sem Estoque</option><option value="com-variacoes">Com Variações</option></select>
                                <select id="filter-active" class="input w-auto"><option value="todos">Todos os Status</option><option value="ativado">Ativado</option><option value="desativado">Desativado</option></select>
                            </div>
                        </div>
                        <div id="product-cards-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
                        <div id="no-products-message" class="hidden card p-12 text-center">
                            <div class="w-16 h-16 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-4">
                                <i data-lucide="package" class="w-8 h-8 text-slate-400"></i>
                            </div>
                            <h3 class="font-medium text-slate-800">Nenhum produto encontrado</h3>
                            <p class="text-sm text-slate-500 mt-1">Clique em "Sincronizar Dados" para carregar os produtos.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ORDERS PAGE -->
            <div id="orders-page" class="page-content hidden flex-col h-full">
                <header class="bg-white border-b border-slate-100 px-8 py-5">
                    <div class="flex items-baseline gap-3">
                        <h1 class="text-xl font-semibold text-slate-800">Painel de Pedidos</h1>
                        <span id="order-count-display" class="text-sm text-slate-400"></span>
                    </div>
                </header>
                <div class="flex-1 overflow-y-auto p-8 bg-slate-50">
                    <div class="container mx-auto">
                        <div class="card p-5 mb-6">
                            <div class="flex-1 min-w-[250px]">
                                <div class="relative">
                                    <i data-lucide="search" class="w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"></i>
                                    <input type="text" id="order-search-input" class="input pl-10" placeholder="Buscar por Cód. do Pedido ou Nome do Cliente...">
                                </div>
                            </div>
                        </div>
                        <div class="card overflow-hidden">
                            <table class="min-w-full divide-y divide-slate-100">
                                <thead class="bg-slate-50">
                                    <tr>
                                        <th class="px-6 py-4 text-left table-header">Cód. Pedido</th>
                                        <th class="px-6 py-4 text-left table-header">Cliente</th>
                                        <th class="px-6 py-4 text-left table-header">Data</th>
                                        <th class="px-6 py-4 text-center table-header">Itens</th>
                                        <th class="px-6 py-4 text-right table-header">Total</th>
                                        <th class="px-6 py-4 text-center table-header">Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="order-list-container" class="bg-white divide-y divide-slate-50"></tbody>
                            </table>
                        </div>
                        <div id="no-orders-message" class="hidden card p-12 text-center">
                            <div class="w-16 h-16 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-4">
                                <i data-lucide="receipt" class="w-8 h-8 text-slate-400"></i>
                            </div>
                            <h3 class="font-medium text-slate-800">Nenhum pedido encontrado</h3>
                            <p class="text-sm text-slate-500 mt-1">Clique em "Sincronizar Dados" para carregar os pedidos.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CAMPAIGNS PAGE -->
            <div id="campaigns-page" class="page-content hidden flex-col h-full">
                <header class="bg-white border-b border-slate-100 px-8 py-5">
                    <div>
                        <h1 class="text-xl font-semibold text-slate-800">Campanhas</h1>
                        <p class="text-sm text-slate-500 mt-0.5">Segmente clientes e dispare mensagens em massa</p>
                    </div>
                </header>
                <div class="flex-1 overflow-y-auto p-8 bg-slate-50">
                    <div class="container mx-auto">
                        <div class="card p-6 mb-6">
                            <div class="flex items-center gap-3 mb-5">
                                <div class="w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center">
                                    <i data-lucide="filter" class="w-4 h-4 text-slate-500"></i>
                                </div>
                                <h3 class="font-semibold text-slate-800">Filtros de Segmentação</h3>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-5">
                                <div><label class="block text-xs font-medium text-slate-500 mb-1.5">Dias sem comprar</label><div class="flex gap-2"><input type="number" id="camp-days-min" class="input" placeholder="Mín"><input type="number" id="camp-days-max" class="input" placeholder="Máx"></div></div>
                                <div><label class="block text-xs font-medium text-slate-500 mb-1.5">Ticket Médio (R$)</label><div class="flex gap-2"><input type="number" id="camp-ticket-min" class="input" placeholder="Mín"><input type="number" id="camp-ticket-max" class="input" placeholder="Máx"></div></div>
                                <div><label class="block text-xs font-medium text-slate-500 mb-1.5">Qtd. de Pedidos</label><div class="flex gap-2"><input type="number" id="camp-orders-min" class="input" placeholder="Mín"><input type="number" id="camp-orders-max" class="input" placeholder="Máx"></div></div>
                                <div><label class="block text-xs font-medium text-slate-500 mb-1.5">Estado (UF)</label><select id="camp-state" class="input"><option value="">Todos</option><option value="SP">São Paulo</option><option value="RJ">Rio de Janeiro</option><option value="MG">Minas Gerais</option><option value="PR">Paraná</option><option value="RS">Rio Grande do Sul</option><option value="SC">Santa Catarina</option><option value="BA">Bahia</option><option value="GO">Goiás</option><option value="PE">Pernambuco</option><option value="CE">Ceará</option></select></div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-5">
                                <div><label class="block text-xs font-medium text-slate-500 mb-1.5">Status (selecione múltiplos)</label><div class="flex flex-wrap gap-2" id="camp-status-checkboxes"><label class="inline-flex items-center cursor-pointer"><input type="checkbox" class="camp-status-check rounded border-slate-300 text-emerald-600" value="ativo"><span class="ml-1.5 badge badge-success">Ativo</span></label><label class="inline-flex items-center cursor-pointer"><input type="checkbox" class="camp-status-check rounded border-slate-300 text-amber-600" value="em-risco"><span class="ml-1.5 badge badge-warning">Em Risco</span></label><label class="inline-flex items-center cursor-pointer"><input type="checkbox" class="camp-status-check rounded border-slate-300 text-red-600" value="inativo"><span class="ml-1.5 badge badge-danger">Inativo</span></label></div></div>
                                <div><label class="block text-xs font-medium text-slate-500 mb-1.5">Já recebeu cupom?</label><select id="camp-has-coupon" class="input"><option value="">Todos</option><option value="no">Nunca recebeu</option><option value="yes">Já recebeu</option><option value="used">Usou cupom</option><option value="not-used">Não usou cupom</option></select></div>
                                <div><label class="block text-xs font-medium text-slate-500 mb-1.5">Tag IA Vigilante</label><select id="camp-ai-tag" class="input"><option value="">Todas</option><option value="urgente">Urgente</option><option value="upsell">Upsell</option><option value="fidelidade">Fidelidade</option><option value="atrasado">Atrasado</option></select></div>
                                <div class="flex items-end"><button id="apply-campaign-filters" class="btn btn-primary w-full"><i data-lucide="search" class="w-4 h-4"></i>Aplicar Filtros</button></div>
                            </div>
                            <div class="flex flex-wrap items-center gap-2 pt-5 border-t border-slate-100">
                                <span class="text-xs text-slate-400 mr-2">Filtros rápidos:</span>
                                <button class="quick-filter badge badge-danger cursor-pointer hover:opacity-80" data-filter="inactive-300">Inativos +300 dias</button>
                                <button class="quick-filter badge badge-warning cursor-pointer hover:opacity-80" data-filter="risk-high-ticket">Em Risco + Ticket Alto</button>
                                <button class="quick-filter badge badge-success cursor-pointer hover:opacity-80" data-filter="vip-inactive">VIPs Inativos</button>
                                <button class="quick-filter badge badge-info cursor-pointer hover:opacity-80" data-filter="first-purchase">Só 1 Compra</button>
                                <button class="quick-filter badge badge-neutral cursor-pointer hover:opacity-80" data-filter="no-coupon">Nunca Recebeu Cupom</button>
                            </div>
                        </div>
                        <div class="card">
                            <div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center">
                                <div><h3 class="font-semibold text-slate-800">Clientes Filtrados</h3><p class="text-sm text-slate-400"><span id="campaign-result-count">0</span> clientes encontrados</p></div>
                                <div class="flex gap-2">
                                    <button id="campaign-generate-coupons" class="btn btn-success text-sm" disabled><i data-lucide="ticket" class="w-4 h-4"></i>Gerar Cupons</button>
                                    <button id="campaign-export" class="btn btn-secondary text-sm" disabled><i data-lucide="download" class="w-4 h-4"></i>Exportar CSV</button>
                                    <button id="campaign-whatsapp" class="btn btn-success text-sm" disabled><i data-lucide="message-circle" class="w-4 h-4"></i>Disparar WhatsApp</button>
                                </div>
                            </div>
                            <div id="campaign-results-list" class="divide-y divide-slate-50 max-h-96 overflow-y-auto">
                                <div class="p-12 text-center">
                                    <div class="w-16 h-16 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-4"><i data-lucide="users" class="w-8 h-8 text-slate-400"></i></div>
                                    <p class="text-slate-600 font-medium">Configure os filtros acima</p>
                                    <p class="text-sm text-slate-400 mt-1">Os clientes filtrados aparecerão aqui</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- COUPONS PAGE -->
            <div id="coupons-page" class="page-content hidden flex-col h-full">
                <header class="bg-white border-b border-slate-100 px-8 py-5">
                    <div class="flex justify-between items-center">
                        <div><h1 class="text-xl font-semibold text-slate-800">Gestão de Cupons</h1><p class="text-sm text-slate-500 mt-0.5">Crie, rastreie e analise ROI dos seus cupons</p></div>
                        <button id="add-coupon-btn" class="btn btn-success"><i data-lucide="plus" class="w-4 h-4"></i> Cadastrar Cupom</button>
                    </div>
                </header>
                <div class="flex-1 overflow-y-auto p-8 bg-slate-50">
                    <div class="container mx-auto">
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-5 mb-8">
                            <div class="metric-card"><div class="flex items-start justify-between"><div><p class="metric-label">Cupons Ativos</p><p class="metric-value text-emerald-600" id="coupon-active-count">0</p></div><div class="w-10 h-10 rounded-xl bg-emerald-50 flex items-center justify-center"><i data-lucide="check-circle" class="w-5 h-5 text-emerald-500"></i></div></div></div>
                            <div class="metric-card"><div class="flex items-start justify-between"><div><p class="metric-label">Cupons Enviados</p><p class="metric-value text-blue-600" id="coupon-sent-count">0</p></div><div class="w-10 h-10 rounded-xl bg-blue-50 flex items-center justify-center"><i data-lucide="send" class="w-5 h-5 text-blue-500"></i></div></div></div>
                            <div class="metric-card"><div class="flex items-start justify-between"><div><p class="metric-label">Cupons Usados</p><p class="metric-value text-violet-600" id="coupon-used-count">0</p></div><div class="w-10 h-10 rounded-xl bg-violet-50 flex items-center justify-center"><i data-lucide="receipt" class="w-5 h-5 text-violet-500"></i></div></div></div>
                            <div class="metric-card"><div class="flex items-start justify-between"><div><p class="metric-label">Taxa Conversão</p><p class="metric-value text-amber-600" id="coupon-conversion-rate">0%</p></div><div class="w-10 h-10 rounded-xl bg-amber-50 flex items-center justify-center"><i data-lucide="percent" class="w-5 h-5 text-amber-500"></i></div></div></div>
                        </div>
                        <div class="card bg-gradient-to-br from-slate-800 to-slate-900 border-0 mb-8">
                            <div class="p-6">
                                <div class="flex items-center gap-3 mb-4"><i data-lucide="sparkles" class="w-5 h-5 text-white"></i><h3 class="text-lg font-semibold text-white">Regras de Cupom Automático</h3></div>
                                <p class="text-sm text-white/70 mb-5">Configure as regras para sugestão automática de cupons</p>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div class="bg-white/10 rounded-xl p-4"><div class="flex items-center gap-2 mb-2"><i data-lucide="gem" class="w-4 h-4 text-white"></i><p class="font-medium text-white">Ticket Alto (R$ 500+)</p></div><p class="text-sm text-white/70">Cupom de 15% para reativação</p><p class="text-xs text-white/50 mt-1">Código: VOLTA15</p></div>
                                    <div class="bg-white/10 rounded-xl p-4"><div class="flex items-center gap-2 mb-2"><i data-lucide="package" class="w-4 h-4 text-white"></i><p class="font-medium text-white">Ticket Médio (R$ 200-500)</p></div><p class="text-sm text-white/70">Cupom de 10%</p><p class="text-xs text-white/50 mt-1">Código: VOLTA10</p></div>
                                    <div class="bg-white/10 rounded-xl p-4"><div class="flex items-center gap-2 mb-2"><i data-lucide="truck" class="w-4 h-4 text-white"></i><p class="font-medium text-white">Ticket Baixo (&lt;R$ 200)</p></div><p class="text-sm text-white/70">Frete Grátis</p><p class="text-xs text-white/50 mt-1">Código: FRETEGRATIS</p></div>
                                </div>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div class="card"><div class="px-6 py-4 border-b border-slate-100"><h3 class="font-semibold text-slate-800">Cupons Cadastrados</h3></div><div id="coupons-list" class="divide-y divide-slate-50 max-h-96 overflow-y-auto"><div class="p-8 text-center"><div class="w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-3"><i data-lucide="ticket" class="w-6 h-6 text-slate-400"></i></div><p class="text-slate-500 text-sm">Nenhum cupom cadastrado</p><p class="text-slate-400 text-xs mt-1">Clique em "Cadastrar Cupom" para começar</p></div></div></div>
                            <div class="card"><div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center"><h3 class="font-semibold text-slate-800">Histórico de Uso</h3><span class="text-sm text-slate-400" id="coupon-history-count">0 usos</span></div><div id="coupon-usage-history" class="divide-y divide-slate-50 max-h-96 overflow-y-auto"><div class="p-8 text-center"><div class="w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-3"><i data-lucide="history" class="w-6 h-6 text-slate-400"></i></div><p class="text-slate-500 text-sm">Nenhum uso registrado</p><p class="text-slate-400 text-xs mt-1">Os usos aparecerão aqui automaticamente</p></div></div></div>
                        </div>
                        <div class="card mt-6"><div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center"><div class="flex items-center gap-3"><i data-lucide="user-check" class="w-5 h-5 text-slate-400"></i><h3 class="font-semibold text-slate-800">Clientes com Cupom Pendente</h3></div><span class="text-sm text-slate-400" id="pending-coupons-count">0 clientes</span></div><div id="pending-coupons-list" class="divide-y divide-slate-50 max-h-64 overflow-y-auto"><div class="p-8 text-center"><div class="w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-3"><i data-lucide="hourglass" class="w-6 h-6 text-slate-400"></i></div><p class="text-slate-500 text-sm">Nenhum cupom pendente</p></div></div></div>
                    </div>
                </div>
            </div>

            <!-- WEBHOOKS PAGE -->
            <div id="webhooks-page" class="page-content hidden flex-col h-full">
                <header class="bg-white border-b border-slate-100 px-8 py-5">
                    <div class="flex justify-between items-center">
                        <h1 class="text-xl font-semibold text-slate-800">Webhooks - Eventos em Tempo Real</h1>
                        <button id="clear-webhook-events" class="btn btn-secondary"><i data-lucide="trash-2" class="w-4 h-4"></i> Limpar Histórico</button>
                    </div>
                </header>
                <div class="flex-1 overflow-y-auto p-8 bg-slate-50">
                    <div class="container mx-auto">
                        <div class="card bg-gradient-to-br from-emerald-600 to-emerald-700 border-0 mb-8">
                            <div class="p-6">
                                <div class="flex items-center gap-3 mb-2"><i data-lucide="link" class="w-5 h-5 text-white"></i><h3 class="text-lg font-semibold text-white">URL do Webhook</h3></div>
                                <p class="text-sm text-white/70 mb-4">Configure esta URL no FacilZap para receber eventos em tempo real</p>
                                <div class="bg-white/10 rounded-xl p-4 flex items-center justify-between">
                                    <code class="text-sm font-mono text-white" id="webhook-url-text">https://crmcjota.netlify.app/.netlify/functions/webhook-handler</code>
                                    <button id="copy-webhook-url-page" class="btn bg-white text-emerald-600 text-sm py-2"><i data-lucide="copy" class="w-4 h-4"></i> Copiar</button>
                                </div>
                                <div class="mt-5 grid grid-cols-2 md:grid-cols-4 gap-3">
                                    <div class="bg-white/10 rounded-xl p-3 text-center"><i data-lucide="package" class="w-6 h-6 text-white mx-auto mb-2"></i><p class="text-xs text-white/80">pedido_criado</p></div>
                                    <div class="bg-white/10 rounded-xl p-3 text-center"><i data-lucide="refresh-cw" class="w-6 h-6 text-white mx-auto mb-2"></i><p class="text-xs text-white/80">pedido_atualizado</p></div>
                                    <div class="bg-white/10 rounded-xl p-3 text-center"><i data-lucide="credit-card" class="w-6 h-6 text-white mx-auto mb-2"></i><p class="text-xs text-white/80">pedido_pago</p></div>
                                    <div class="bg-white/10 rounded-xl p-3 text-center"><i data-lucide="shopping-cart" class="w-6 h-6 text-white mx-auto mb-2"></i><p class="text-xs text-white/80">carrinho_abandonado</p></div>
                                </div>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-5 mb-8">
                            <div class="metric-card"><div class="flex items-start justify-between"><div><p class="metric-label">Eventos Hoje</p><p class="metric-value" id="webhook-events-today">0</p></div><div class="w-10 h-10 rounded-xl bg-blue-50 flex items-center justify-center"><i data-lucide="calendar" class="w-5 h-5 text-blue-500"></i></div></div></div>
                            <div class="metric-card"><div class="flex items-start justify-between"><div><p class="metric-label">Novos Pedidos</p><p class="metric-value text-emerald-600" id="webhook-new-orders">0</p></div><div class="w-10 h-10 rounded-xl bg-emerald-50 flex items-center justify-center"><i data-lucide="shopping-bag" class="w-5 h-5 text-emerald-500"></i></div></div></div>
                            <div class="metric-card"><div class="flex items-start justify-between"><div><p class="metric-label">Carrinhos Abandonados</p><p class="metric-value text-amber-600" id="webhook-abandoned-carts">0</p></div><div class="w-10 h-10 rounded-xl bg-amber-50 flex items-center justify-center"><i data-lucide="shopping-cart" class="w-5 h-5 text-amber-500"></i></div></div></div>
                            <div class="metric-card"><div class="flex items-start justify-between"><div><p class="metric-label">Valor Recuperável</p><p class="metric-value text-violet-600" id="webhook-recoverable-value">R$ 0</p></div><div class="w-10 h-10 rounded-xl bg-violet-50 flex items-center justify-center"><i data-lucide="banknote" class="w-5 h-5 text-violet-500"></i></div></div></div>
                        </div>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div class="card"><div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center"><div class="flex items-center gap-3"><i data-lucide="shopping-cart" class="w-5 h-5 text-amber-500"></i><h3 class="font-semibold text-slate-800">Carrinhos Abandonados</h3></div><span class="text-sm text-slate-400" id="abandoned-carts-count">0 carrinhos</span></div><div id="abandoned-carts-list" class="divide-y divide-slate-50 max-h-96 overflow-y-auto"><div class="p-8 text-center"><div class="w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-3"><i data-lucide="inbox" class="w-6 h-6 text-slate-400"></i></div><p class="text-slate-500 text-sm">Nenhum carrinho abandonado</p><p class="text-slate-400 text-xs mt-1">Configure o webhook no FacilZap para receber alertas</p></div></div></div>
                            <div class="card"><div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center"><div class="flex items-center gap-3"><i data-lucide="history" class="w-5 h-5 text-blue-500"></i><h3 class="font-semibold text-slate-800">Histórico de Eventos</h3></div><span class="text-sm text-slate-400" id="events-count">0 eventos</span></div><div id="webhook-events-list" class="divide-y divide-slate-50 max-h-96 overflow-y-auto"><div class="p-8 text-center"><div class="w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-3"><i data-lucide="radio" class="w-6 h-6 text-slate-400"></i></div><p class="text-slate-500 text-sm">Aguardando eventos...</p><p class="text-slate-400 text-xs mt-1">Os eventos aparecerão aqui quando o FacilZap enviar</p></div></div></div>
                        </div>
                        <div class="mt-6 card bg-blue-50 border-blue-100">
                            <div class="p-6">
                                <div class="flex items-center gap-2 mb-3"><i data-lucide="info" class="w-5 h-5 text-blue-600"></i><h4 class="font-semibold text-blue-800">Como Configurar no FacilZap</h4></div>
                                <ol class="text-sm text-blue-700 space-y-2 list-decimal list-inside">
                                    <li>Acesse sua conta no <strong>FacilZap</strong></li>
                                    <li>No menu lateral, clique em <strong>Integrações</strong></li>
                                    <li>Clique no submenu <strong>Webhooks</strong></li>
                                    <li>Cole a URL acima e <strong>ative</strong> o webhook</li>
                                    <li>Ative os eventos: <strong>Pedido Criado</strong>, <strong>Pedido Atualizado</strong>, <strong>Carrinho Abandonado</strong></li>
                                    <li>Clique em <strong>Salvar</strong></li>
                                </ol>
                                <p class="text-xs text-blue-600 mt-3 flex items-center gap-1"><i data-lucide="alert-triangle" class="w-3 h-3"></i>A URL deve retornar código 200. O FacilZap faz até 3 tentativas em caso de falha.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- GROWTH PAGE -->
            <div id="growth-page" class="page-content hidden flex-col h-full">
                <header class="bg-white border-b border-slate-100 px-8 py-5">
                    <div class="flex items-baseline justify-between">
                        <div><h1 class="text-xl font-semibold text-slate-800">Análise Estratégica</h1><p class="text-sm text-slate-500">Seu assistente de Growth com IA</p></div>
                        <button id="refresh-analysis-btn" class="btn btn-secondary"><i data-lucide="refresh-cw" class="w-4 h-4"></i> Atualizar Análise</button>
                    </div>
                </header>
                <div class="flex-1 overflow-y-auto p-8 bg-slate-50">
                    <div class="container mx-auto">
                        <div id="growth-kpis" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5 mb-8"></div>
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                            <div id="temp-quente" class="card card-hover cursor-pointer border-l-4 border-l-red-500"><div class="p-6"><div class="flex items-start justify-between"><div><div class="flex items-center gap-2 mb-1"><i data-lucide="flame" class="w-4 h-4 text-red-500"></i><p class="text-sm text-slate-500">Clientes Quentes</p></div><p class="text-3xl font-bold text-red-600" id="count-quente">0</p><p class="text-xs text-slate-400 mt-1">Compraram nos últimos 30 dias</p></div></div></div></div>
                            <div id="temp-morno" class="card card-hover cursor-pointer border-l-4 border-l-amber-500"><div class="p-6"><div class="flex items-start justify-between"><div><div class="flex items-center gap-2 mb-1"><i data-lucide="thermometer" class="w-4 h-4 text-amber-500"></i><p class="text-sm text-slate-500">Clientes Mornos</p></div><p class="text-3xl font-bold text-amber-600" id="count-morno">0</p><p class="text-xs text-slate-400 mt-1">30-90 dias sem comprar</p></div></div></div></div>
                            <div id="temp-frio" class="card card-hover cursor-pointer border-l-4 border-l-blue-500"><div class="p-6"><div class="flex items-start justify-between"><div><div class="flex items-center gap-2 mb-1"><i data-lucide="snowflake" class="w-4 h-4 text-blue-500"></i><p class="text-sm text-slate-500">Clientes Frios</p></div><p class="text-3xl font-bold text-blue-600" id="count-frio">0</p><p class="text-xs text-slate-400 mt-1">+90 dias sem comprar (Churn Risk)</p></div></div></div></div>
                        </div>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                            <div class="card"><div class="px-6 py-4 border-b border-slate-100"><div class="flex items-center gap-3"><i data-lucide="crown" class="w-5 h-5 text-amber-500"></i><h3 class="font-semibold text-slate-800">Clientes VIP</h3></div></div><div id="vip-list" class="space-y-3 max-h-64 overflow-y-auto p-4"></div></div>
                            <div class="card"><div class="px-6 py-4 border-b border-slate-100"><div class="flex items-center gap-3"><i data-lucide="map-pin" class="w-5 h-5 text-blue-500"></i><h3 class="font-semibold text-slate-800">Clientes por Estado</h3></div></div><div id="state-distribution" class="grid grid-cols-3 gap-2 max-h-64 overflow-y-auto p-4"></div></div>
                        </div>
                        <div class="card bg-gradient-to-br from-slate-800 to-slate-900 border-0 mb-8">
                            <div class="p-6">
                                <div class="flex items-center gap-3 mb-2"><i data-lucide="brain" class="w-5 h-5 text-white"></i><h3 class="text-lg font-semibold text-white">Assistente de IA</h3></div>
                                <p class="text-sm text-white/70 mb-5">Deixe a IA analisar seus dados e sugerir estratégias</p>
                                <div class="flex flex-wrap gap-3">
                                    <button id="ai-suggest-params-btn" class="btn bg-amber-400 text-slate-900 hover:bg-amber-300"><i data-lucide="brain" class="w-4 h-4"></i> IA: Sugerir Parâmetros Ideais</button>
                                    <button id="ai-reactivation-btn" class="btn bg-white text-slate-800 hover:bg-slate-100"><i data-lucide="sparkles" class="w-4 h-4"></i> Gerar Estratégia de Reativação</button>
                                    <button id="ai-vip-btn" class="btn bg-white text-slate-800 hover:bg-slate-100"><i data-lucide="crown" class="w-4 h-4"></i> Estratégia para VIPs</button>
                                </div>
                                <div id="ai-response" class="mt-5 hidden bg-white/10 rounded-xl p-4"></div>
                            </div>
                        </div>
                        <div id="segment-clients" class="card hidden"><div class="px-6 py-4 border-b border-slate-100 flex justify-between items-center"><h3 class="font-semibold text-slate-800" id="segment-title">Clientes do Segmento</h3><div class="flex gap-2"><button id="bulk-message-btn" class="btn btn-success"><i data-lucide="message-circle" class="w-4 h-4"></i> Mensagem em Massa</button></div></div><div id="segment-client-list" class="space-y-2 max-h-96 overflow-y-auto p-4"></div></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- MODALS -->
    <div id="client-modal" class="fixed z-50 inset-0 overflow-y-auto hidden"><div class="flex items-center justify-center min-h-screen p-4"><div class="fixed inset-0 modal-overlay"></div><div class="relative bg-white rounded-2xl shadow-xl max-w-lg w-full"><form id="client-form"><div class="p-6"><h3 class="text-lg font-semibold text-slate-800 mb-5" id="modal-title">Adicionar Novo Cliente</h3><input type="hidden" id="client-id"><div class="space-y-4"><div><label for="name" class="block text-sm font-medium text-slate-600 mb-1.5">Nome</label><input type="text" id="name" class="input" required></div><div><label for="email" class="block text-sm font-medium text-slate-600 mb-1.5">Email</label><input type="email" id="email" class="input"></div><div><label for="phone" class="block text-sm font-medium text-slate-600 mb-1.5">Telefone</label><input type="tel" id="phone" class="input"></div><div><label for="birthday" class="block text-sm font-medium text-slate-600 mb-1.5">Aniversário</label><input type="date" id="birthday" class="input"></div></div></div><div class="bg-slate-50 px-6 py-4 rounded-b-2xl flex justify-end gap-3"><button type="button" id="cancel-button" class="btn btn-secondary">Cancelar</button><button type="submit" class="btn btn-primary">Salvar</button></div></form></div></div></div>
    <div id="details-modal" class="fixed z-50 inset-0 overflow-y-auto hidden"><div class="flex items-center justify-center min-h-screen p-4"><div class="fixed inset-0 modal-overlay"></div><div class="relative bg-white rounded-2xl shadow-xl max-w-3xl w-full"><div class="p-6"><div class="flex justify-between items-start mb-4"><h3 class="text-lg font-semibold text-slate-800" id="details-modal-title">Detalhes do Cliente</h3><button id="close-details-button" class="text-slate-400 hover:text-slate-600"><i data-lucide="x" class="w-5 h-5"></i></button></div><div id="details-modal-content" class="max-h-[70vh] overflow-y-auto"></div></div></div></div></div>
    <div id="settings-modal" class="fixed z-50 inset-0 overflow-y-auto hidden"><div class="flex items-center justify-center min-h-screen p-4"><div class="fixed inset-0 modal-overlay"></div><div class="relative bg-white rounded-2xl shadow-xl max-w-2xl w-full"><form id="settings-form"><div class="p-6 max-h-[80vh] overflow-y-auto"><h3 class="text-lg font-semibold text-slate-800 mb-6">Configurações</h3><div class="mb-6"><h4 class="font-medium text-slate-700 mb-1">Status dos Clientes</h4><p class="text-sm text-slate-500 mb-4">Defina os intervalos em dias para cada status.</p><div class="space-y-4"><div><label for="status-ativo-days" class="block text-sm font-medium text-slate-600 mb-1.5">Cliente Ativo (até X dias)</label><input type="number" id="status-ativo-days" class="input" required></div><div><label for="status-risco-days" class="block text-sm font-medium text-slate-600 mb-1.5">Cliente em Risco (até X dias)</label><input type="number" id="status-risco-days" class="input" required></div><p class="text-xs text-slate-400">Acima do valor "Em Risco", o cliente é "Inativo".</p></div></div><div class="mb-6 pt-6 border-t border-slate-100"><div class="flex items-center gap-2 mb-1"><i data-lucide="brain" class="w-4 h-4 text-slate-500"></i><h4 class="font-medium text-slate-700">Integração com IA (Groq - Limites Generosos)</h4></div><p class="text-sm text-slate-500 mb-4">Configure sua API Key do Groq (GRATUITO - 14.400 req/dia).</p><div><label for="groq-api-key" class="block text-sm font-medium text-slate-600 mb-1.5">API Key do Groq</label><input type="password" id="groq-api-key" class="input" placeholder="gsk_..."></div><p class="text-xs text-slate-400 mt-2">Obtenha GRÁTIS em: console.groq.com/keys</p></div><div class="pt-6 border-t border-slate-100"><div class="flex items-center gap-2 mb-1"><i data-lucide="zap" class="w-4 h-4 text-slate-500"></i><h4 class="font-medium text-slate-700">Webhooks (Tempo Real)</h4></div><p class="text-sm text-slate-500 mb-4">Receba notificações automáticas quando pedidos são criados ou atualizados.</p><div class="card bg-emerald-50 border-emerald-100 p-4 mb-4"><div class="flex items-center justify-between mb-2"><span class="text-sm font-medium text-slate-700">URL do Webhook:</span><button type="button" id="copy-webhook-url" class="text-emerald-600 hover:text-emerald-800 text-sm flex items-center gap-1"><i data-lucide="copy" class="w-3 h-3"></i> Copiar</button></div><div class="bg-white rounded-lg px-3 py-2 font-mono text-sm text-slate-800 break-all" id="webhook-url-display">https://crmcjota.netlify.app/.netlify/functions/webhook-handler</div></div></div></div><div class="bg-slate-50 px-6 py-4 rounded-b-2xl flex justify-end gap-3"><button type="button" id="cancel-settings-button" class="btn btn-secondary">Cancelar</button><button type="submit" class="btn btn-primary">Salvar</button></div></form></div></div></div>
    <div id="confirm-modal" class="fixed z-50 inset-0 overflow-y-auto hidden"><div class="flex items-center justify-center min-h-screen p-4"><div class="fixed inset-0 modal-overlay"></div><div class="relative bg-white rounded-2xl shadow-xl max-w-lg w-full"><div class="p-6"><div class="flex items-start gap-4"><div class="w-10 h-10 rounded-full bg-red-100 flex items-center justify-center flex-shrink-0"><i data-lucide="alert-triangle" class="w-5 h-5 text-red-600"></i></div><div><h3 class="text-lg font-semibold text-slate-800">Excluir Cliente</h3><p class="text-sm text-slate-500 mt-1">Tem certeza que deseja excluir este cliente? Esta ação é irreversível.</p></div></div></div><div class="bg-slate-50 px-6 py-4 rounded-b-2xl flex justify-end gap-3"><button type="button" id="cancel-delete-button" class="btn btn-secondary">Cancelar</button><button type="button" id="confirm-delete-button" class="btn btn-danger">Excluir</button></div></div></div></div>
    <div id="whatsapp-modal" class="fixed z-50 inset-0 overflow-y-auto hidden"><div class="flex items-center justify-center min-h-screen p-4"><div class="fixed inset-0 modal-overlay"></div><div class="relative bg-white rounded-2xl shadow-xl max-w-lg w-full"><div class="p-6"><div class="flex justify-between items-start mb-5"><div class="flex items-center gap-3"><div class="w-10 h-10 rounded-full bg-emerald-100 flex items-center justify-center"><i data-lucide="message-circle" class="w-5 h-5 text-emerald-600"></i></div><h3 class="text-lg font-semibold text-slate-800">Enviar Mensagem</h3></div><button id="close-whatsapp-modal" class="text-slate-400 hover:text-slate-600"><i data-lucide="x" class="w-5 h-5"></i></button></div><div class="mb-4"><label class="block text-sm font-medium text-slate-600 mb-1.5">Cliente</label><p id="whatsapp-client-name" class="font-semibold text-slate-800"></p><p id="whatsapp-client-phone" class="text-sm text-slate-500"></p></div><div class="mb-4"><label class="block text-sm font-medium text-slate-600 mb-1.5">Mensagem</label><textarea id="whatsapp-message" rows="5" class="input"></textarea><div class="flex justify-between mt-2"><button id="generate-ai-message" class="text-slate-600 text-sm hover:text-slate-800 flex items-center gap-1"><i data-lucide="sparkles" class="w-3 h-3"></i> Gerar com IA</button><button id="generate-basic-message" class="text-slate-600 text-sm hover:text-slate-800 flex items-center gap-1"><i data-lucide="file-text" class="w-3 h-3"></i> Template Básico</button></div></div></div><div class="bg-slate-50 px-6 py-4 rounded-b-2xl flex justify-end gap-3"><button type="button" id="cancel-whatsapp-btn" class="btn btn-secondary">Cancelar</button><button id="send-whatsapp-btn" class="btn btn-success"><i data-lucide="message-circle" class="w-4 h-4"></i> Abrir WhatsApp</button></div></div></div></div>
    <div id="import-modal" class="fixed z-50 inset-0 overflow-y-auto hidden"><div class="flex items-center justify-center min-h-screen p-4"><div class="fixed inset-0 modal-overlay"></div><div class="relative bg-white rounded-2xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden"><div class="bg-slate-800 px-6 py-4 flex justify-between items-center"><div class="flex items-center gap-3"><i data-lucide="file-up" class="w-5 h-5 text-white"></i><h3 class="text-lg font-semibold text-white">Importar Dados de Legado</h3></div><button id="close-import-modal" class="text-white/70 hover:text-white"><i data-lucide="x" class="w-5 h-5"></i></button></div><div class="px-6 py-4 bg-slate-50 border-b border-slate-100"><div class="flex items-center justify-center space-x-4"><div id="step1-indicator" class="flex items-center"><span class="w-8 h-8 rounded-full bg-slate-800 text-white flex items-center justify-center text-sm font-medium">1</span><span class="ml-2 text-sm font-medium text-slate-800">Upload</span></div><div class="w-16 h-0.5 bg-slate-300" id="step1-line"></div><div id="step2-indicator" class="flex items-center opacity-50"><span class="w-8 h-8 rounded-full bg-slate-300 text-slate-600 flex items-center justify-center text-sm font-medium">2</span><span class="ml-2 text-sm font-medium text-slate-500">Mapear Colunas</span></div><div class="w-16 h-0.5 bg-slate-300" id="step2-line"></div><div id="step3-indicator" class="flex items-center opacity-50"><span class="w-8 h-8 rounded-full bg-slate-300 text-slate-600 flex items-center justify-center text-sm font-medium">3</span><span class="ml-2 text-sm font-medium text-slate-500">Importar</span></div></div></div><div class="px-6 py-6 overflow-y-auto" style="max-height: 60vh;"><div id="import-step-1"><div class="mb-4"><label class="block text-sm font-medium text-slate-600 mb-2">Tipo de dados a importar:</label><div class="flex space-x-4"><label class="flex items-center cursor-pointer"><input type="radio" name="import-type" value="clientes" class="mr-2" checked><span class="text-sm">Clientes</span></label><label class="flex items-center cursor-pointer"><input type="radio" name="import-type" value="pedidos" class="mr-2"><span class="text-sm">Pedidos</span></label><label class="flex items-center cursor-pointer"><input type="radio" name="import-type" value="produtos" class="mr-2"><span class="text-sm">Produtos</span></label></div></div><div id="dropzone" class="border-2 border-dashed border-slate-200 rounded-2xl p-12 text-center hover:border-slate-400 hover:bg-slate-50 transition-all cursor-pointer"><div class="w-16 h-16 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-4"><i data-lucide="upload-cloud" class="w-8 h-8 text-slate-400"></i></div><p class="text-lg font-medium text-slate-700">Arraste seu arquivo aqui</p><p class="text-sm text-slate-500 mt-2">ou clique para selecionar</p><p class="text-xs text-slate-400 mt-4">Formatos aceitos: CSV, XLSX, XLS</p><input type="file" id="file-input" accept=".csv,.xlsx,.xls" class="hidden"></div><div id="file-info" class="mt-4 hidden"><div class="card bg-emerald-50 border-emerald-100 p-4 flex items-center justify-between"><div class="flex items-center gap-3"><i data-lucide="file-spreadsheet" class="w-6 h-6 text-emerald-600"></i><div><p id="file-name" class="font-medium text-slate-800"></p><p id="file-rows" class="text-sm text-slate-500"></p></div></div><button id="remove-file" class="text-red-500 hover:text-red-700"><i data-lucide="x" class="w-5 h-5"></i></button></div></div></div><div id="import-step-2" class="hidden"><div class="mb-4"><p class="text-sm text-slate-600 mb-4 flex items-center gap-2"><i data-lucide="info" class="w-4 h-4 text-slate-400"></i>Mapeie as colunas do seu arquivo para os campos do sistema. Campos com <span class="text-red-500">*</span> são obrigatórios.</p></div><div id="mapping-container" class="space-y-3"></div><div class="mt-6 card bg-slate-50 p-4"><div class="flex items-center gap-2 mb-3"><i data-lucide="eye" class="w-4 h-4 text-slate-500"></i><h4 class="font-medium text-slate-800">Prévia dos Dados (primeiras 3 linhas)</h4></div><div id="data-preview" class="overflow-x-auto"><table class="min-w-full text-xs"><thead id="preview-header"></thead><tbody id="preview-body"></tbody></table></div></div></div><div id="import-step-3" class="hidden"><div id="import-progress" class="mb-6"><div class="flex items-center justify-center mb-4"><div class="w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center animate-pulse"><i data-lucide="loader-2" class="w-6 h-6 text-slate-600 animate-spin"></i></div></div><p class="text-center text-slate-600">Processando importação...</p><div class="w-full bg-slate-200 rounded-full h-2 mt-4"><div id="progress-bar" class="bg-slate-800 h-2 rounded-full transition-all" style="width: 0%"></div></div><p id="progress-text" class="text-center text-sm text-slate-500 mt-2">0%</p></div><div id="import-result" class="hidden"><div class="text-center mb-6"><div class="w-16 h-16 rounded-full bg-emerald-100 flex items-center justify-center mx-auto mb-4"><i data-lucide="check" class="w-8 h-8 text-emerald-600"></i></div><h4 class="text-xl font-semibold text-slate-800">Importação Concluída!</h4></div><div class="grid grid-cols-3 gap-4 mb-6"><div class="card bg-emerald-50 p-4 text-center"><p class="text-2xl font-bold text-emerald-600" id="result-new">0</p><p class="text-sm text-slate-600">Novos Registros</p></div><div class="card bg-blue-50 p-4 text-center"><p class="text-2xl font-bold text-blue-600" id="result-merged">0</p><p class="text-sm text-slate-600">Registros Mesclados</p></div><div class="card bg-amber-50 p-4 text-center"><p class="text-2xl font-bold text-amber-600" id="result-skipped">0</p><p class="text-sm text-slate-600">Ignorados (duplicados)</p></div></div><div id="import-warnings" class="hidden card bg-amber-50 border-amber-100 p-4 mb-4"><div class="flex items-center gap-2 mb-2"><i data-lucide="alert-triangle" class="w-4 h-4 text-amber-600"></i><h5 class="font-medium text-amber-800">Avisos</h5></div><ul id="warnings-list" class="text-sm text-amber-700 list-disc list-inside"></ul></div></div></div></div><div class="bg-slate-50 px-6 py-4 flex justify-between items-center border-t border-slate-100"><button id="import-back-btn" class="btn btn-secondary hidden"><i data-lucide="arrow-left" class="w-4 h-4"></i>Voltar</button><div class="flex-1"></div><button id="import-next-btn" class="btn btn-primary" disabled>Próximo <i data-lucide="arrow-right" class="w-4 h-4"></i></button><button id="import-finish-btn" class="btn btn-success hidden"><i data-lucide="check" class="w-4 h-4"></i>Concluir</button></div></div></div></div>
    <div id="coupon-modal" class="fixed z-50 inset-0 overflow-y-auto hidden"><div class="flex items-center justify-center min-h-screen p-4"><div class="fixed inset-0 modal-overlay"></div><div class="relative bg-white rounded-2xl shadow-xl max-w-lg w-full"><form id="coupon-form"><div class="p-6"><div class="flex items-center gap-3 mb-5"><div class="w-10 h-10 rounded-full bg-emerald-100 flex items-center justify-center"><i data-lucide="ticket" class="w-5 h-5 text-emerald-600"></i></div><h3 class="text-lg font-semibold text-slate-800">Cadastrar Cupom</h3></div><p class="text-sm text-slate-500 mb-5 flex items-center gap-2"><i data-lucide="info" class="w-4 h-4"></i>Crie o cupom no FacilZap primeiro, depois cadastre aqui para rastrear uso.</p><div class="space-y-4"><div><label class="block text-sm font-medium text-slate-600 mb-1.5">Código do Cupom *</label><input type="text" id="coupon-code" class="input uppercase" placeholder="Ex: VOLTA15" required></div><div><label class="block text-sm font-medium text-slate-600 mb-1.5">Descrição</label><input type="text" id="coupon-description" class="input" placeholder="Ex: Cupom de reativação 15%"></div><div class="grid grid-cols-2 gap-4"><div><label class="block text-sm font-medium text-slate-600 mb-1.5">Tipo de Desconto</label><select id="coupon-type" class="input"><option value="percent">Porcentagem (%)</option><option value="fixed">Valor Fixo (R$)</option><option value="shipping">Frete Grátis</option></select></div><div><label class="block text-sm font-medium text-slate-600 mb-1.5">Valor</label><input type="number" id="coupon-value" class="input" placeholder="Ex: 15"></div></div><div class="grid grid-cols-2 gap-4"><div><label class="block text-sm font-medium text-slate-600 mb-1.5">Validade</label><input type="date" id="coupon-expiry" class="input"></div><div><label class="block text-sm font-medium text-slate-600 mb-1.5">Limite de Uso</label><input type="number" id="coupon-limit" class="input" placeholder="Ilimitado"></div></div><div><label class="block text-sm font-medium text-slate-600 mb-1.5">Regra de Aplicação</label><select id="coupon-rule" class="input"><option value="all">Todos os clientes</option><option value="inactive">Apenas inativos (+90 dias)</option><option value="high-ticket">Ticket alto (+R$ 500)</option><option value="low-ticket">Ticket baixo (-R$ 200)</option><option value="vip">Apenas VIPs</option></select></div></div></div><div class="bg-slate-50 px-6 py-4 rounded-b-2xl flex justify-end gap-3"><button type="button" id="cancel-coupon-btn" class="btn btn-secondary">Cancelar</button><button type="submit" class="btn btn-success"><i data-lucide="save" class="w-4 h-4"></i>Salvar Cupom</button></div></form></div></div></div>
    <div id="bulk-whatsapp-modal" class="fixed z-50 inset-0 overflow-y-auto hidden"><div class="flex items-center justify-center min-h-screen p-4"><div class="fixed inset-0 modal-overlay"></div><div class="relative bg-white rounded-2xl shadow-xl max-w-3xl w-full"><div class="p-6"><div class="flex items-center gap-3 mb-5"><div class="w-10 h-10 rounded-full bg-emerald-100 flex items-center justify-center"><i data-lucide="message-circle" class="w-5 h-5 text-emerald-600"></i></div><h3 class="text-lg font-semibold text-slate-800">Disparo em Massa</h3></div><div class="card bg-amber-50 border-amber-100 p-4 mb-5"><p class="text-sm text-amber-800 flex items-center gap-2"><i data-lucide="alert-triangle" class="w-4 h-4"></i><strong>Atenção:</strong> Os links serão abertos um a um. O WhatsApp não permite automação direta.</p></div><div class="mb-4"><p class="text-sm text-slate-600"><span id="bulk-client-count" class="font-bold text-slate-800">0</span> clientes selecionados</p></div><div class="card bg-violet-50 border-violet-100 p-4 mb-5"><div class="flex items-center justify-between mb-3"><span class="text-sm font-medium text-violet-800 flex items-center gap-2"><i data-lucide="sparkles" class="w-4 h-4"></i>Gerador de Variações com IA</span><button id="generate-ai-variations" class="btn bg-violet-600 text-white text-xs py-1.5 px-3 hover:bg-violet-700"><i data-lucide="wand-2" class="w-3 h-3"></i>Gerar 3 Variações</button></div><div id="ai-variations-container" class="hidden space-y-2"><p class="text-xs text-violet-600 mb-2">Clique para usar:</p><div id="ai-variations-list" class="space-y-2"></div></div><p id="ai-variations-loading" class="hidden text-xs text-violet-600 flex items-center gap-2"><i data-lucide="loader-2" class="w-3 h-3 animate-spin"></i>Gerando variações com IA...</p></div><div class="mb-4"><label class="block text-sm font-medium text-slate-600 mb-1.5">Mensagem</label><textarea id="bulk-message-text" rows="6" class="input" placeholder="Use {nome} para personalizar com o nome do cliente e {cupom} para inserir o código do cupom">Olá {nome}!

Sentimos sua falta!

Preparamos um cupom especial pra você: {cupom}

Aproveite e volte a comprar conosco!</textarea></div><div><label class="block text-sm font-medium text-slate-600 mb-1.5">Cupom a incluir</label><select id="bulk-coupon-select" class="input"><option value="">Nenhum cupom</option></select></div></div><div class="bg-slate-50 px-6 py-4 rounded-b-2xl flex justify-end gap-3"><button type="button" id="cancel-bulk-btn" class="btn btn-secondary">Cancelar</button><button type="button" id="start-bulk-dispatch" class="btn btn-success"><i data-lucide="message-circle" class="w-4 h-4"></i>Iniciar Disparo</button></div></div></div></div>

    <div id="toast-container" class="toast-container"></div>
    
    <script src="script.js"></script>
    <script>lucide.createIcons();</script>
</body>
</html>
